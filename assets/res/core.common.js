var _prefix='[CORE.COMMON]';var COMPUTER=0,ANDROID=1,DEVICE=ANDROID,VEVENT={};if(navigator.platform&&(navigator.platform=='Win32'||navigator.platform=='MacIntel')){DEVICE=COMPUTER;console.log(_prefix+'DEVICE:'+DEVICE);}
if(DEVICE==COMPUTER){VEVENT={mouseup:'mouseup',mousedown:'mousedown',mousemove:'mousemove',mouseout:'mouseout'};}else{VEVENT={mouseup:'touchend',mousedown:'touchstart',mousemove:'touchmove',mouseout:'touchcancel'};}
isAndroid=(/android/gi).test(navigator.appVersion);isIDevice=(/iphone|ipad/gi).test(navigator.appVersion);isTouchPad=(/hp-tablet/gi).test(navigator.appVersion);(function(){var A=window.navigator.userAgent.toLowerCase();setTimeout(function(){if(/android 2/.test(A)){document.getElementById('addStyle').setAttribute("href","/css/style_android_2.css");}},1);})();document.addEventListener('WeixinJSBridgeReady',function onBridgeReady()
{WeixinJSBridge.on('menu:setfont',function(argv){var num=parseInt(argv.fontSize);});WeixinJSBridge.on('menu:share:appmessage',function(argv){sendShareCommand('sendAppMessage');});WeixinJSBridge.on('menu:share:timeline',function(argv){sendShareCommand('shareTimeline');});WeixinJSBridge.on('menu:share:weibo',function(argv){var opt=getShareOptions('shareWeibo');if(opt==false)return;if(opt.link=="http://w.gaopeng.com/cinema-activty/index"){WeixinJSBridge.invoke('shareWeibo',{"content":'亲们，微团购邀您共赏《金刚狼2》，尊享200元大礼包，快来抢购吧！打开微信，在添加好友中查找公众号【微团购】或【weituangou】，关注后就能参加各种活动，抓紧时间啦！',"url":'http://act.gaopeng.qq.com/huodong/c2/882/'},function(res){});return;}
    WeixinJSBridge.invoke('shareWeibo',{"content":'你听说过吗，在微信里也能团购啦！无需注册、登陆，打开微信就能团！ 在添加朋友中搜索【weituangou】或【微团购】,关注后就可以体验在微 信里团购啦，快去尝鲜吧~关注方法详见 http://act.gaopeng.com/huodong/c2/284/',"url":opt.link},function(res){});});function sendShareCommand(command){var opt=getShareOptions(command);if(opt==false)return;if(!command||command!='sendAppMessage'){try{var _arg={};if(typeof command!='undefined'&&command!=null)_arg.shareType=command;if(typeof dealId!='undefined'&&dealId!=null)_arg.dealId=dealId;_arg.shareUrl=encodeURIComponent(window.location.pathname);shareHandle(_arg);}catch(e){}}
    WeixinJSBridge.invoke(command,{"appid":'wx8e4c7364a259befb',"img_url":opt.img,"img_width":"470","img_height":"310","link":opt.link,"desc":opt.desc,"title":opt.title},function(res){WeixinJSBridge.log(res.err_msg);if(res&&res.err_msg&&(res.err_msg.indexOf('confirm')>-1||res.err_msg.indexOf('ok')>-1)){var _arg={};if(typeof command!='undefined'&&command!=null)_arg.shareType=command;if(typeof dealId!='undefined'&&dealId!=null)_arg.dealId=dealId;_arg.shareUrl=encodeURIComponent(window.location.pathname);shareHandle(_arg);}});}
    function shareHandle(o){console.log(o);if(!o)return false;$.post('/ajax/site/share',o,function(data){});}
    function getShareOptions(command)
    {var server_host=WT.SERVER_HOST.substr(WT.SERVER_HOST,WT.SERVER_HOST.length);var shareImageDef=server_host+'/images/share_def.png';if(!WT.Share.option){if(command=='sendAppMessage'){return{title:'微团购-微信上的团购！',desc:'无需注册、登陆，打开微信就能团！微团购-腾讯旗下高朋网唯一 官方微信账户',link:server_host,img:shareImageDef};}
    else{return{title:'微团购-腾讯旗下高朋网唯一官方微信账户',desc:'',link:server_host,img:shareImageDef};}}
        var cinemaActivity=[629989,629991,629993,629995,629997,629999,630001,630003,630005,630007];var dealId=WT.Share.option.dealid;var imgUrl=WT.Share.option.img;var sms=WT.Share.option.sms||'全球最大的团购品牌';var short=WT.Share.option.short||'腾讯旗下高朋网唯一官方微信账户';var link=WT.Share.option.dealid?server_host+'/deal/detail/'+dealId+'?S=4':server_host;if(!command||command!='sendAppMessage'){command='shareTimeline';}
        if(command=='sendAppMessage'){if($.inArray(dealId,cinemaActivity)>=0){link="http://w.gaopeng.com/cinema-activty/index";return{title:sms,desc:short,link:link,img:imgUrl};}
            return{title:'微团购-'+sms,desc:short,link:link,img:imgUrl};}
        else{if($.inArray(dealId,cinemaActivity)>=0){link="http://w.gaopeng.com/cinema-activty/index";return{title:sms,desc:short,link:link,img:imgUrl};}
            return{title:'微团购-'+short,desc:'',link:link,img:imgUrl};}}
    WeixinJSBridge.log('yo~ ready.');},false);